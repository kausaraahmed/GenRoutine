<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <!-- <link rel="stylesheet" href="styles.css"> -->
    <title>Routine Generator</title>
</head>

<body>

    <!-- Title area -->
    <div class="title-area">
        <h1>Routinio</h1>
        <p>generate routines effortlessly</p>
    </div>

    <!-- Content area -->
    <div class="content">

        <!-- Course input -->
        <div class="course-input">

            <!-- course input title -->
            <div class="input-title">Courses</div>

            <!-- input area -->
            <div class="input-area">
                <input type="text" id="course-code" class="course-code" placeholder="Enter Course code">

                <!-- course ctype (theory / lab) -->
                <div class="course-type">
                    <button id="theory-btn" class="theory-btn" value="theory">Theory</button>
                    <button id="lab-btn" class="lab-btn" value="lab">Lab</button>
                </div>

                <!-- course details selection -->
                <div class="details-selection">

                    <!-- course day start-->
                    <div class="course-day">

                        <!-- theory day -->
                        <div id="t-day" class="theory-day">
                            <label><input type="radio" id="day-sun-tue" name="day" value="sun">SUN - TUE</label>
                            <label><input type="radio" id="day-mon-wed" name="day" value="mon">MON - WED</label>
                        </div>

                        <!-- lab day -->
                        <div id="l-day" class="lab-day">
                            <label><input type="radio" id="day-sun" name="day" value="sun">SUN</label>
                            <label><input type="radio" id="day-mon" name="day" value="mon">MON</label>
                            <label><input type="radio" id="day-tue" name="day" value="tue">TUE</label>
                            <label><input type="radio" id="day-wed" name="day" value="wed">WED</label>
                            <label><input type="radio" id="day-thu" name="day" value="thu">THU</label>
                        </div>

                    </div>
                    <!-- course day end -->


                    <!-- course time start -->
                    <div class="course-time" id="course-time">

                        <!-- theory time -->
                        <div id="theory-time" class="theory-time">
                            <label><input type="radio" id="time-8-00" name="time" value="8:00"> 8:00-9:20</label>
                            <label><input type="radio" id="time-9-25" name="time" value="9:25"> 9:25-10:45</label>
                            <label><input type="radio" id="time-10-50" name="time" value="10:50"> 10:50-12:10</label>
                            <label><input type="radio" id="time-12-15" name="time" value="12:15"> 12:15-1:35</label>
                            <label><input type="radio" id="time-1-40" name="time" value="1:40"> 1:40-3:00</label>
                            <label><input type="radio" id="time-3-05" name="time" value="3:05"> 3:05-4:25</label>
                            <label><input type="radio" id="time-4-30" name="time" value="4:30"> 4:30-5:50</label>
                        </div>

                        <!-- lab time -->
                        <div id="lab-time" class="lab-time">
                            <label><input type="radio" id="time-8-00" name="time" value="8:00"> 8:00-10:45</label>
                            <label><input type="radio" id="time-9-25" name="time" value="9:25"> 9:25-12:10</label>
                            <label><input type="radio" id="time-10-50" name="time" value="10:50"> 10:50-1:35</label>
                            <label><input type="radio" id="time-12-15" name="time" value="12:15"> 12:15-3:00</label>
                            <label><input type="radio" id="time-1-40" name="time" value="1:40"> 1:40-4:25</label>
                            <label><input type="radio" id="time-3-05" name="time" value="3:05"> 3:05-5:50</label>
                        </div>

                    </div>
                    <!-- course time end -->

                </div>

            </div>
            <!-- course details selection -->

            <!-- add button -->
            <button class="add-btn" id="add-btn">ADD</button>

        </div>
        <!-- course input end -->


        <!-- Routine table -->
        <div class="routine-table" id="routine-table">
            <table id="myTable">
                <tr>
                    <th></th>
                    <th>8:00 - 9:20</th>
                    <th>9:25 - 10:45</th>
                    <th>10:50 - 12:10</th>
                    <th>12:15 - 1:35</th>
                    <th>1:40 - 3:00</th>
                    <th>3:05 - 4:25</th>
                    <th>4:30 - 5:50</th>
                </tr>
                <tr>
                    <th>Saturday</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <th>Sunday</th>
                    <td id="cell-0-0"></td>
                    <td id="cell-0-1"></td>
                    <td id="cell-0-2"></td>
                    <td id="cell-0-3"></td>
                    <td id="cell-0-4"></td>
                    <td id="cell-0-5"></td>
                    <td id="cell-0-6"></td>
                </tr>
                <tr>
                    <th>Monday</th>
                    <td id="cell-1-0"></td>
                    <td id="cell-1-1"></td>
                    <td id="cell-1-2"></td>
                    <td id="cell-1-3"></td>
                    <td id="cell-1-4"></td>
                    <td id="cell-1-5"></td>
                    <td id="cell-1-6"></td>
                </tr>
                <tr>
                    <th>Tuesday</th>
                    <td id="cell-2-0"></td>
                    <td id="cell-2-1"></td>
                    <td id="cell-2-2"></td>
                    <td id="cell-2-3"></td>
                    <td id="cell-2-4"></td>
                    <td id="cell-2-5"></td>
                    <td id="cell-2-6"></td>
                </tr>
                <tr>
                    <th>Wednesday</th>
                    <td id="cell-3-0"></td>
                    <td id="cell-3-1"></td>
                    <td id="cell-3-2"></td>
                    <td id="cell-3-3"></td>
                    <td id="cell-3-4"></td>
                    <td id="cell-3-5"></td>
                    <td id="cell-3-6"></td>
                </tr>
                <tr>
                    <th>Thursday</th>
                    <td id="cell-4-0"></td>
                    <td id="cell-4-1"></td>
                    <td id="cell-4-2"></td>
                    <td id="cell-4-3"></td>
                    <td id="cell-4-4"></td>
                    <td id="cell-4-5"></td>
                    <td id="cell-4-6"></td>
                </tr>
            </table>
        </div>
        <!-- routine table end -->

        <!-- Tools -->
        <div>
            <button class="clearing-btn" id="clear-btn">Clear</button>
            <button class="clearing-btn" id="clear-all-btn">Clear All</button>
        </div>

    </div>

    <script>
        let selectedCourseType = ' ';

        document.getElementById('theory-btn').addEventListener('click', function () {
            const t_day = document.getElementById('t-day');
            const l_day = document.getElementById('l-day');
            const t_time = document.getElementById('theory-time');
            const l_time = document.getElementById('lab-time');
            const labBtn = document.getElementById('lab-btn');
            const theoryBtn = document.getElementById('theory-btn');

            // Set the selected course ctype to 'theory'
            selectedCourseType = 'theory';

            t_day.style.display = 'flex';
            l_day.style.display = 'none';
            t_time.style.display = 'flex';
            l_time.style.display = 'none';
            theoryBtn.style.backgroundColor = '#141619'
            theoryBtn.style.color = 'white'
            labBtn.style.border = '2px solid lightgray'
            labBtn.style.backgroundColor = 'transparent'
            labBtn.style.color = '#141619'
        })

        document.getElementById('lab-btn').addEventListener('click', function () {
            const t_day = document.getElementById('t-day');
            const l_day = document.getElementById('l-day');
            const t_time = document.getElementById('theory-time');
            const l_time = document.getElementById('lab-time');
            const labBtn = document.getElementById('lab-btn');
            const theoryBtn = document.getElementById('theory-btn');

            // Set the selected course ctype to 'lab'
            selectedCourseType = 'lab';

            console.log('lab');
            t_day.style.display = 'none';
            l_day.style.display = 'flex';
            t_time.style.display = 'none';
            l_time.style.display = 'flex';
            labBtn.style.backgroundColor = '#141619'
            labBtn.style.color = 'white'
            theoryBtn.style.border = '2px solid lightgray'
            theoryBtn.style.backgroundColor = 'transparent'
            theoryBtn.style.color = '#141619'
        })

        document.getElementById('add-btn').addEventListener('click', function () {
            const course_code = document.getElementById('course-code').value;
            let course_type = ' ';

            // Use the selected course ctype
            if (selectedCourseType == ' ') {
                course_type = 'theory';
            } else {
                course_type = selectedCourseType;
            }

            const course_day = document.querySelector('input[name="day"]:checked').value;
            const course_time = document.querySelector('input[name="time"]:checked').value;

            console.log(`Course Code: ${course_code}`);
            console.log(`Course Type: ${course_type}`);
            console.log(`Course Day: ${course_day}`);
            console.log(`Course Time: ${course_time}`);

            fetch('/dummy', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: `course_code=${course_code}&course_day=${course_day}&course_type=${course_type}&course_time=${course_time}`
            })
                .then(response => response.json())
                .then(data => {
                    const table = data.table;
                    const conflict = data.conflict;

                    if (conflict) {
                        alert("Course conflict!! Select another course.");
                    }

                    for (let i = 0; i < table.length; i++) {
                        for (let j = 0; j < 7; j++) {
                            document.getElementById(`cell-${i}-${j}`).innerHTML = `<pre>${table[i][j]}</pre>`;
                        }
                    }
                }).catch(error => console.error('Error:', error));
        });

        document.getElementById('clear-all-btn').addEventListener('click', function () {
            fetch('/clear', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: ``
            })
                .then(response => response.json())
                .then(data => {

                    for (let i = 0; i < data.length; i++) {
                        for (let j = 0; j < 7; j++) {
                            document.getElementById(`cell-${i}-${j}`).innerHTML = `<pre>${data[i][j]}</pre>`;
                        }
                    }
                })
                .catch(error => console.error('Error:', error));
        });
    </script>

</body>

</html>